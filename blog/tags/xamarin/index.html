<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Coding Thoughts Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Coding Thoughts Blog Atom Feed"><title data-react-helmet="true">Posts tagged &quot;xamarin&quot; | Coding Thoughts</title><meta data-react-helmet="true" property="og:title" content="Posts tagged &quot;xamarin&quot; | Coding Thoughts"><meta data-react-helmet="true" name="description" content="Blog | Tagged &quot;xamarin&quot;"><meta data-react-helmet="true" property="og:description" content="Blog | Tagged &quot;xamarin&quot;"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/styles.157dcc77.css">
<link rel="preload" href="/styles.4fbf0ec5.js" as="script">
<link rel="preload" href="/runtime~main.fc898453.js" as="script">
<link rel="preload" href="/main.ece73c67.js" as="script">
<link rel="preload" href="/1.4ea9cb82.js" as="script">
<link rel="preload" href="/2.dd29e16f.js" as="script">
<link rel="preload" href="/6875c492.dfa2ff96.js" as="script">
<link rel="preload" href="/ccb03a98.23fefe2f.js" as="script">
<link rel="preload" href="/4be9694a.f3e9695f.js" as="script">
<link rel="preload" href="/921f360c.a9e06855.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/chalk.jpg" alt="Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/chalk.jpg" alt="Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Khaled Hikmat</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/khaledhikmat" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/chalk.jpg" alt="Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/chalk.jpg" alt="Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Khaled Hikmat</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/khaledhikmat" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--2"><div class="sidebar_SWld thin-scrollbar"><h3 class="sidebarItemTitle_Km2m">Recent posts</h3><ul class="sidebarItemList_3UpA"><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2018/01/06/kubernetes-vs-service-fabric">Kubernetes vs. Service Fabric</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2018/01/04/netapp-docker-k8s">.NET Core, Docker and Kubernetes</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2018/01/02/azure-cli-login-options">Azure CLI Notes</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2017/12/27/durable-functions">Actors in Serverless</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2017/12/21/point-to-site-connectivity">Point to Site Connectivity in Azure</a></li></ul></div></div><main class="col col--8"><h1>1 post tagged with &quot;xamarin&quot;</h1><a href="/blog/tags">View All Tags</a><div class="margin-vert--xl"><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog/2016/11/24/presentation-evaluation">Xamarin Forms App using VS for mac</a></h2><div class="margin-vert--md"><time datetime="2016-11-24T00:00:00.000Z" class="blogPostDate_Ta7i">November 24, 2016  Â· 6 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/khaledhikmat" target="_blank" rel="noreferrer noopener"><img src="https://avatars1.githubusercontent.com/u/3119726?s=400&amp;u=090899e7b366dd702f9d0d5e483f20089010b25c&amp;v=4" alt="Khaled Hikmat"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/khaledhikmat" target="_blank" rel="noreferrer noopener">Khaled Hikmat</a></h4><small class="avatar__subtitle">Software Engineer</small></div></div></header><section class="markdown"><p>I am new to Xamarin development and I also wanted to try the newly announced VS for mac! So I created a little Camera app that can be used to evaluate presentations. The app allows the user to take a <code>selfie</code>. When committed, the picture is sent to an Azure cognitive function to extract the gender, male and smile (a measure of emotion). The app then displays the taken picture and returned result in the app. It also sends the result to PowerBI real-time stream to allow the visualization of the evaluation results.</p><p>So in essence, a user uses the app to take a selfie with a smile or a frown to indicate whether the presentation was good, not so good or somewhere in between. For example, if the user submitted a picture that looks like this:</p><p><img src="http://i.imgur.com/QPF0LI8.png" alt="Evaluation"></p><p>The cognitive result might look like this:</p><p><img src="http://i.imgur.com/0U4IaRH.png" alt="Cognitive Result"></p><p>and the result will be pushed in real-time to a PowerBI dashboard:</p><p><img src="http://i.imgur.com/XvnGaVs.png" alt="PowerBI"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="xamarin-app"></a>Xamarin App<a class="hash-link" href="#xamarin-app" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="taking-a-camera-picture"></a>Taking a Camera picture<a class="hash-link" href="#taking-a-camera-picture" title="Direct link to heading">#</a></h3><p>Using VS for mac, I created a blank XAML forms app solution with Android and iOS. Added the following Xamarin plugin to all of its projects (portable, iOS and Droid):</p><ul><li>Xam.Plugin.Media</li></ul><p>This allows me to use the Camera without having to deal with iOs or Android. I wrote the following simple XAML in the main page:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;ContentPage xmlns=&quot;http://xamarin.com/schemas/2014/forms&quot; </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        xmlns:x=&quot;http://schemas.microsoft.com/winfx/2009/xaml&quot; </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        xmlns:local=&quot;clr-namespace:PresentationEvaluation&quot; </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        x:Class=&quot;PresentationEvaluation.PresentationEvaluationPage&quot;&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;StackLayout&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;Button x:Name=&quot;btnTakePicture&quot; Clicked=&quot;btnTakePicture_Clicked&quot; Text=&quot;Take selfie with emotion&quot;/&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;ActivityIndicator x:Name=&quot;Indicator&quot; Color=&quot;Black&quot;/&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;StackLayout x:Name=&quot;ResultPanel&quot; Padding=&quot;10&quot;&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;Image x:Name=&quot;Image&quot; HeightRequest=&quot;240&quot; /&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;StackLayout x:Name=&quot;Age&quot; Orientation=&quot;Horizontal&quot;&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &lt;Label&gt;Age&lt;/Label&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &lt;Label x:Name=&quot;AgeData&quot;&gt;&lt;/Label&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;/StackLayout&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;StackLayout x:Name=&quot;Gender&quot; Orientation=&quot;Horizontal&quot;&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &lt;Label&gt;Gender&lt;/Label&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &lt;Label x:Name=&quot;GenderData&quot;&gt;&lt;/Label&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;/StackLayout&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;StackLayout x:Name=&quot;Smile&quot; Orientation=&quot;Horizontal&quot;&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &lt;Label&gt;Smile&lt;/Label&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &lt;Label x:Name=&quot;SmileData&quot;&gt;&lt;/Label&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;/StackLayout&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;Label x:Name=&quot;Result&quot;&gt;&lt;/Label&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;/StackLayout&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;/StackLayout&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/ContentPage&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>and I had this in the behind code:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace PresentationEvaluation</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public partial class PresentationEvaluationPage : ContentPage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public PresentationEvaluationPage()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            InitializeComponent();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ResultPanel.IsVisible = false;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        private async void btnTakePicture_Clicked(object sender, EventArgs e)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            try</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                await CrossMedia.Current.Initialize();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if (!CrossMedia.Current.IsCameraAvailable || !CrossMedia.Current.IsTakeVideoSupported)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    throw new Exception($&quot;There is no camera on the device!&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                var file = await CrossMedia.Current.TakePhotoAsync(new Plugin.Media.Abstractions.StoreCameraMediaOptions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    SaveToAlbum = true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    Name = &quot;SelfieEvaluation.jpg&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if (file == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    throw new Exception($&quot;Picture not captured to disk!!&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                Image.Source = ImageSource.FromStream(() =&gt; file.GetStream());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                //TODO: Do something with the image </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            catch (Exception ex)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                await DisplayAlert(&quot;Sorry&quot;, &quot;An error occurred: &quot; + ex.Message, &quot;Ok&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            finally</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="communicating-with-cognitive"></a>Communicating with Cognitive<a class="hash-link" href="#communicating-with-cognitive" title="Direct link to heading">#</a></h3><p>Now that we got the picture from the Camera, I wanted to send it to Azure Cognitive to detect the age, gender and smile. I added some NuGet packages:</p><ul><li>Microsoft.Net.Http</li><li>Newton.Json</li></ul><p>First I had to convert the media image file to an array of bytes:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">public static byte[] GetBytes(MediaFile file)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    byte[] fileBytes = null;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using (var ms = new MemoryStream())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        file.GetStream().CopyTo(ms);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        file.Dispose();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        fileBytes = ms.ToArray();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return fileBytes;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Then submitted to the congnitive APIs:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">        byte[] picture = GetBytes(file);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        float age = -1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        string gender = &quot;&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        float smile = -1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Submit to Cognitive</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        using (var httpClient = new HttpClient())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            httpClient.DefaultRequestHeaders.Add(&quot;Ocp-Apim-Subscription-Key&quot;, &quot;get-your-own&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            HttpResponseMessage response;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            var content = new ByteArrayContent(picture);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            content.Headers.ContentType = new MediaTypeHeaderValue(&quot;application/octet-stream&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            response = await httpClient.PostAsync(FacialApi, content);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            string responseData = await response.Content.ReadAsStringAsync();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if (!response.IsSuccessStatusCode)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                throw new Exception($&quot;Unable to post to cognitive service: {response.StatusCode.ToString()}&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            Face[] faces = JsonConvert.DeserializeObject&lt;Face[]&gt;(responseData);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if (faces != null &amp;&amp; faces.Length &gt; 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                Face face = faces[0];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                age = face.faceAttributes.age;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                gender = face.faceAttributes.gender;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                smile = face.faceAttributes.smile;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Where the Face classes are defined as follows (I just special pasted the docs JSON example into my Visual Studio to create these classes):</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class Face</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public string faceId { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Facerectangle faceRectangle { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Faceattributes faceAttributes { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public string glasses { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Headpose headPose { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class Facerectangle</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int width { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int height { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int left { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int top { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class Faceattributes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public float age { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public string gender { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public float smile { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Facialhair facialHair { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class Facialhair</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public float mustache { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public float beard { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public float sideburns { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class Headpose</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public float roll { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int yaw { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int pitch { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Because I have a free cognitive account and I could be throttled, I created a randomizer to generate random values in case i don&#x27;t wato to use the cognitive functions for testing. So I created a flag that I can change whenever I want to test without cognitive:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">// Submit to Cognitive</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if (IsCognitive)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///same as above</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    gender = genders.ElementAt(random.Next(genders.Count - 1));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    age = ages.ElementAt(random.Next(ages.Count - 1));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    smile = smiles.ElementAt(random.Next(smiles.Count - 1));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="powerbi"></a>PowerBI<a class="hash-link" href="#powerbi" title="Direct link to heading">#</a></h3><p>Once I get the result back from the cognitive function, I create a real time event (and refer to the smile range as score after I multiply it by 10) and send it to <a href="https://powerbi.microsoft.com/en-us/documentation/powerbi-service-real-time-streaming/" target="_blank" rel="noopener noreferrer">PowerBI real-time</a> very useful feature which displays visualizations in real-time:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-csharp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">using (var httpClient = new HttpClient())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var realTimeEvent = new</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        time = DateTime.Now,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        age = (int)age,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        score = (int)(smile * 10),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        gender = gender</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var data = new dynamic[1];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    data[0] = realTimeEvent;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var postData = JsonConvert.SerializeObject(data);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    HttpContent httpContent = new StringContent(postData, Encoding.UTF8, &quot;application/json&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    HttpResponseMessage response = await httpClient.PostAsync(PowerBIApi, httpContent);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    string responseString = await response.Content.ReadAsStringAsync();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!response.IsSuccessStatusCode)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        throw new Exception(&quot;Unable to post to PowerBI: &quot; + response.StatusCode);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>where PowerBIApi is the real-time API that you must post it. You will get this from PowerPI service when you create your own Real-Time dataset.</p><p>This allows people to watch the presentation evaluation result in real-time:</p><p><img src="http://i.imgur.com/XvnGaVs.png" alt="PowerBI"></p><p>That was a nice exercise! I liked the ease of developing stuff in Xamarin forms as it shields me almost completely from Android and iOS. Visual Studio for mac (in preview), however, has a lot of room of improvement...it feels heavy, clunky and a bit buggy. Finally I would like to say that, in non-demo situations, it is probably better to send the picture to an Azure storage which will trigger an Azure Function that will send to cognitive and PowerBI. </p><p>The code is available in GitHub <a href="https://github.com/khaledhikmat/presentation-evaluation" target="_blank" rel="noopener noreferrer">here</a></p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/xamarin">Xamarin</a></div><div class="col text--right"><a aria-label="Read more about Xamarin Forms App using VS for mac" href="/blog/2016/11/24/presentation-evaluation"><strong>Read More</strong></a></div></footer></article></div></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2020 Khaled Hikmat site, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.4fbf0ec5.js"></script>
<script src="/runtime~main.fc898453.js"></script>
<script src="/main.ece73c67.js"></script>
<script src="/1.4ea9cb82.js"></script>
<script src="/2.dd29e16f.js"></script>
<script src="/6875c492.dfa2ff96.js"></script>
<script src="/ccb03a98.23fefe2f.js"></script>
<script src="/4be9694a.f3e9695f.js"></script>
<script src="/921f360c.a9e06855.js"></script>
</body>
</html>