
<!DOCTYPE html>
<html lang="en">
        <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

        <title>Khaled Hikmat - Custom Views in iOS</title>
        <meta name="description" content="Coding Thoughts" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">        

        <link type="application/rss+xml" rel="alternate" title="Khaled Hikmat" href="/feed.rss" />
        <link type="application/atom+xml" rel="alternate" title="Khaled Hikmat" href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" />
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/clean-blog.css" rel="stylesheet" />
        <link href="/assets/css/master.css" rel="stylesheet" />
        <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
        <link href="/assets/css/override.css" rel="stylesheet" />


        <meta name="application-name" content="Khaled Hikmat" />
        <meta name="msapplication-tooltip" content="Khaled Hikmat" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Khaled Hikmat - Custom Views in iOS" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://blog.khaledhikmat.com/posts/2014-01-05-custom-views-in-ios" />
        <!-- TODO: More social graph meta tags -->

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>     
        <script src="/assets/js/highlight.pack.js"></script>   
        <script src="/assets/js/clean-blog.js"></script>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script src="/assets/js/trianglify.min.js"></script>
        <script src="/assets/js/Please-compressed.js"></script>
                
        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->


        </head>
        <body>
                
                <!-- Navigation -->
                <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
                        <div class="container-fluid">
                                <!-- Brand and toggle get grouped for better mobile display -->
                                <div class="navbar-header page-scroll">
                                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        </button>
                                        <a class="navbar-brand" href="/">Khaled Hikmat</a>
                                </div>
                        
                                <!-- Collect the nav links, forms, and other content for toggling -->
                                <div class="collapse navbar-collapse" id="navbar-collapse">
                                        <ul class="nav navbar-nav navbar-right">
                                                <li><a href="/about">About</a></li>
<li><a href="/posts">Archive</a></li>
<li><a href="/tags">Tags</a></li> 
                                        </ul>
                                </div>
                                <!-- /.navbar-collapse -->
                        </div>
                        <!-- /.container -->
                </nav>
                
                <!-- Page Header -->
                <header class="intro-header" id="intro-header">
                        <div class="container">
                                <div class="row">
                                        <div class="col-md-12">

    
<div class="post-heading">
    <h1>Custom Views in iOS</h1>
        <h2 class="subheading">A sample of how to create custom views in iOS</h2>
    <div class="meta">        
Published on Sunday, January 5, 2014<br>    </div>
        <div class="tags">
                    <a role="button" href="/tags/custom-views" class="btn btn-default btn-xs">Custom Views</a>
                    <a role="button" href="/tags/ios" class="btn btn-default btn-xs">iOS</a>
        </div>     
</div>
                                        </div>
                                </div>
                        </div>
                </header>
                
                <!-- Main Content -->
                <div class="container">
                        <div class="row">
                                <div id="content" class="col-md-12">
                                        

<p>Recently I started working on an iOS app ...so I had to learn the iOS platform and Objective C. For my experience on this, please check my post here.</p>
<p>In an effort to re-factor the code and make things more organized in my iOS app, I sat out to add custom views to my app. I discovered this is a very convoluted process and most the stackflow posts led me to confusions and different ways to do things. After several iterations and several hours, I came up with a reasonable approach. This post details what I did.</p>
<p>Assuming you have an iOS app based on storyboards (I am using iOS7 and Xcode 5), start by adding a new UI View item in Xcode. Let us call this new XIB file 'HeaderView.xib':</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-14.49.19.png)</p>
<p>My test custom view is quite simple...it should only have a label and a button. Drag a label and a button so that it looks like this:</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-14.52.17.png)</p>
<p>Add a new Objective C class and make it extend UIView. Let us call it HeaderView. So your project file hierarchy might look something like this:</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-15.15.50.png)</p>
<p>Now comes the tricky part.... open up your XIB file and assign the file owner (in the placeholder) to the newly created HeaderView custom class:</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-15.17.34.png)</p>
<p>But leave the View's custom class to UIView:</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-15.17.52.png)</p>
<p>This is really important and it the source of my confusion when I read how other people have done this. Anyway, let make the custom view do something by creating an action from the button:</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-14.54.58.png)</p>
<p>Now open up the Custom View .m file and add this method:</p>
<pre><code>- (id) initWithCoder:(NSCoder *)aDecoder {
    self = [super initWithCoder:aDecoder];
    if (self) {
        HeaderView * hView = [[[NSBundle mainBundle] loadNibNamed:&#64;&quot;HeaderView&quot; owner:self options:nil] lastObject];
        [self addSubview:hView];
    }
    return self;
}
</code></pre>
<p>Note the following about the above piece of code:</p>
<ul>
<li>We are overriding initWithCoder as opposed to initWithFrame. This is recommended in Apple's dev documentation.</li>
<li>We are using the bundle to decode the XIB file. This returns an array ...we are using the last object and assign it to a local variable</li>
<li>We are adding the newly loaded view as a subview</li>
</ul>
<p>Your entire HeaderView.m file should look like something like this:</p>
<pre><code>&#64;implementation HeaderView

- (id) initWithCoder:(NSCoder *)aDecoder {
    self = [super initWithCoder:aDecoder];
    if (self) {
        HeaderView * hView = [[[NSBundle mainBundle] loadNibNamed:&#64;&quot;HeaderView&quot; owner:self options:nil] lastObject];
        [self addSubview:hView];
    }
    return self;
}

#pragma Action Handlers

- (IBAction)buttonClicked:(id)sender {
}
&#64;end
</code></pre>
<p>Now that we have this nifty custom view designed, let us test it out in a view controller. Create a new ViewController class called <code>TestCustomViewController</code>:</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-15.22.32.png)</p>
<p>Drag in a new view controller to your storyboard. Assign the newly created view controller custom class to the view controller:</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-15.24.56.png)</p>
<p>Drag a UIView to the view controller, size it manually and give it a background color so it becomes recognizable:</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-15.27.30.png)</p>
<p>Now assign our custom view class i.e. HeaderView to this new UIView like so:</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-15.29.14.png)</p>
<p>This new UIView that you dragged onto the view controller is actually a place holder. We will place our custom view inside it in a bit.</p>
<p>Now create an outlet in the TestCustomViewController.h for the new UIView:</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-15.32.43.png)</p>
<p>Your TestCustiomViewController.h should look something like this:</p>
<pre><code>#import &lt;UIKit/UIKit.h&gt;

#import &quot;HeaderView.h&quot;

&#64;interface TestCustomViewController : UIViewController
&#64;property (weak, nonatomic) IBOutlet HeaderView *headerView;

&#64;end
</code></pre>
<p>When the view controller is loaded, the custom view is already loaded with it and the headerView property already contains an instance of the HeaderView. Verify this by running your app and navigate to the TestCustomViewController. You should see the custom view loaded in the place holder in the test view controller.</p>
<p>Now that the app is running and the view controller has an instance of the custom view, let us test that by adding a method in the custom view which we can call from the view controller. So add an API method in the HeaderView.h and implement it in the .m file like this:</p>
<pre><code>&#64;interface HeaderView : UIView
- (IBAction)buttonClicked:(id)sender;

-(void) sayHello;
&#64;end
</code></pre>
<pre><code>&#64;implementation HeaderView

- (id) initWithCoder:(NSCoder *)aDecoder {
    self = [super initWithCoder:aDecoder];
    if (self) {
        HeaderView * hView = [[[NSBundle mainBundle] loadNibNamed:&#64;&quot;HeaderView&quot; owner:self options:nil] lastObject];
        [self addSubview:hView];
    }
    return self;
}

#pragma Action Handlers

- (IBAction)buttonClicked:(id)sender {
}

#pragma Custom View APIs Implementation

-(void) sayHello {
    NSLog(&#64;&quot;Hello from my header view!!!&quot;);
}
&#64;end
</code></pre>
<p>In the View Controller's viewDidLoad method, add a call to the 'sayHello' message and watch it appear in the output window:</p>
<pre><code>- (void)viewDidLoad
{
    [super viewDidLoad];
	// Do any additional setup after loading the view.
    [self.headerView sayHello];
}
</code></pre>
<p>Great....now we have a way to create a custom view as XIB, load it in our view controller and communicate with it via a set of messages we define in its public interface.</p>
<p>one more thing left to do. Let us add a way to make the custom view pluggable in different view controllers. For example, we want to delegate processing the click handler to the view controller so it can do its thing. Let us define a new delegate like this:</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-16.16.12.png)</p>
<p>![UI View Item]({{ site.baseurl }}/images/2014-01-05/Screenshot-2014-01-05-16.16.32.png)</p>
<p>Your HeaderViewDelegate.h file should look something like this:</p>
<pre><code>&#64;protocol HeaderViewDelegate 
-(void) handleClick;
&#64;end
</code></pre>
<p>Let us modify the ViewController to become an implementer of this protocol:</p>
<pre><code>#import &quot;HeaderView.h&quot;
#import &quot;HeaderViewDelegate.h&quot;

&#64;interface TestCustomViewController : UIViewController 
&#64;property (weak, nonatomic) IBOutlet HeaderView *headerView;
&#64;end
</code></pre>
<p>The TestCustomViewController.m file:</p>
<pre><code>&#64;implementation TestCustomViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
	// Do any additional setup after loading the view.
    [self.headerView sayHello];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma HeaderViewDelegate Implementation

-(void) handleClick {
    NSLog(&#64;&quot;handleClick handler&quot;);
}
&#64;end
</code></pre>
<p>Let us modify the HeaderView code to accept a delegate and call the delegate when the button is clicked. First the HeaderView.h:</p>
<pre><code>#import &lt;UIKit/UIKit.h&gt;

#import &quot;HeaderViewDelegate.h&quot;

&#64;interface HeaderView : UIView
&#64;property (nonatomic) id delegate;

- (IBAction)buttonClicked:(id)sender;

-(void) sayHello;
&#64;end
</code></pre>
<p>Modify the custom view implementation action handler method to look like this:</p>
<pre><code>#pragma Action Handlers

- (IBAction)buttonClicked:(id)sender {
    if (self.delegate != nil)
        [self.delegate handleClick];
}
</code></pre>
<p>One final thing...let us assign the view controller to be the delegate for the custom view. So modify the view controller viewDidLoad method to look like this:</p>
<pre><code>- (void)viewDidLoad
{
    [super viewDidLoad];

    // Assign self to be the delegate for the custom view
    self.headerView.delegate = self;

    // Do any additional setup after loading the view.
    [self.headerView sayHello];
}
</code></pre>
<p>Now if you run the app and click on the custom view's button, you should see the view controller's handleClick gets called.</p>
<p>Given this test custom view, you can build more sophisticated custom views that can plug in view controllers. The ability to delegate calls back to the view controllers decouples the view code from its parent.</p>



                                </div>
                        </div>
                </div>
                
                <hr>
                
                <!-- Footer -->
                <footer>
                        <div class="container">
        <div class="row">
                <div class="col-md-12">
                <ul class="list-inline text-center">
                        <li>
                        <a href="https://twitter.com/khaledhmat">
                                <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                        </a>
                        </li>
                        <li>
                        <a href="https://github.com/khaledhikmat">
                                <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                        </a>
                        </li>
                </ul>
                <p class="copyright text-muted">
                        Copyright © 2016 by Khaled Hikmat. 
                        <br />
                        <strong><a href="http://wyam.io">Generated by Wyam</a></strong>
                </p>
                </div>
        </div>
</div>
                </footer> 

                <script type="text/javascript">
</script>
                <script>hljs.initHighlightingOnLoad();</script>

                        <script type="text/javascript">                
                                // Header background                        
                                var colors = Please.make_color({
                                        colors_returned: 3,
                                        saturation: .6
                                });
                                var t = new Trianglify({
                                        x_gradient: colors,
                                        y_gradient: ["#FFFFFF"]
                                });
                                var header = document.getElementById("intro-header");
                                var pattern = t.generate(header.clientWidth, header.clientHeight);
                                header.setAttribute('style', 'background-image: ' + pattern.dataUrl);                        
                        </script>
        </body>
</html>

